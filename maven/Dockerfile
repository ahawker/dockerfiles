# dockerfiles/maven
#
# Dockerfile for Maven
ARG REPO
ARG BASE_IMAGE
ARG TAG=latest

FROM $REPO/$BASE_IMAGE:$TAG

ARG LABEL_PREFIX
ARG MAVEN_VERSION
ARG ALPINE_MAVEN_PACKAGE_NAME
ARG ALPINE_MAVEN_PACKAGE_VERSION

RUN test -n "$LABEL_PREFIX" && \
    test -n "$MAVEN_VERSION" && \
    test -n "$ALPINE_MAVEN_PACKAGE_NAME" && \
    test -n "$ALPINE_MAVEN_PACKAGE_VERSION"

LABEL $LABEL_PREFIX.maven.version=$MAVEN_VERSION \
      $LABEL_PREFIX.alpine.maven.package.name=$ALPINE_MAVEN_PACKAGE_NAME \
      $LABEL_PREFIX.alpine.maven.package.version=$ALPINE_MAVEN_PACKAGE_VERSION

ENV MAVEN_VERSION=$MAVEN_VERSION \
    ALPINE_MAVEN_PACKAGE_NAME=$ALPINE_MAVEN_PACKAGE_NAME \
    ALPINE_MAVEN_PACKAGE_VERSION=$ALPINE_MAVEN_PACKAGE_VERSION

USER root

RUN apk add --no-cache $ALPINE_MAVEN_PACKAGE_NAME="$ALPINE_MAVEN_PACKAGE_VERSION"

USER $USER
