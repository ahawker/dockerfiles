# dockerfiles/nginx
#
# Dockerfile for https://github.com/nginx/nginx
ARG REPO
ARG BASE_IMAGE
ARG TAG=latest

FROM $REPO/$BASE_IMAGE:$TAG

ARG LABEL_PREFIX
ARG NGINX_VERSION
ARG ALPINE_NGINX_PACKAGE_NAME
ARG ALPINE_NGINX_PACKAGE_VERSION

RUN test -n "$LABEL_PREFIX" && \
    test -n "$NGINX_VERSION" && \
    test -n "$ALPINE_NGINX_PACKAGE_NAME" && \
    test -n "$ALPINE_NGINX_PACKAGE_VERSION"

LABEL $LABEL_PREFIX.nginx.version=$NGINX_VERSION

ENV NGINX_VERSION=$NGINX_VERSION

USER root

RUN apk add --no-cache \
    $ALPINE_NGINX_PACKAGE_NAME="$ALPINE_NGINX_PACKAGE_VERSION"

USER $USR
